{% extends 'common/base.html' %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/personnalisation_fiche.css') }}">
{% endblock %}

{% block javascripts %}
    <script src="{{ url_for('static',filename='js/personnalisation_fiche.js') }}"></script>
{% endblock %}

{% block body %}
    <h1>Personnalisation de la fiche</h1>

    <div id="container-principal">
        <div id="zone_preview">
            <h3>Prévisualisation</h3>
            <select id="selecteur_categorie" onchange="changer_preview(this)" class="my-3">
                {% for categorie in composition %}
                    <option value="{{ categorie["position_elem"] }}">{{ categorie["libelle_elem"] }}</option>
                {% endfor %}
            </select>
            {% for categorie in composition %}
                <fieldset id="field-{{ categorie["position_elem"] }}" class="scheduler-border p-2 mr-auto ml-2"
                          {% if loop.index0 != 0 %}hidden="" {% endif %}>
                    <legend >{{ categorie["libelle_elem"] }}</legend>
                    {% for element in categorie["elements"] %}
                        {% if element["type_elem"] == "select-time" %}
                            <label>
                                {{ element["libelle_elem"] }}
                                <select class="selecteur_temps">
                                    <option value="">0:30</option>
                                    {% for h in range(1, 10) %}
                                        {% for m in range(0, 4, 3) %}
                                            <option value="">{{ h }}:{{ m }}0</option>
                                        {% endfor %}
                                    {% endfor %}
                                </select>
                            </label>
                        {% elif element["type_elem"] == "select-materiel" %}
                            <label>
                                {{ element["libelle_elem"] }}
                                <select class="selecteur_temps">
                                    <option value="mat-1">materiel 1</option>
                                    <option value="mat-2">materiel 2</option>
                                </select>
                            </label>
                        {% elif element["type_elem"] == "textarea" %}
                            <label>
                                {{ element["libelle_elem"] }}
                                <textarea></textarea>
                            </label>
                        {% else %}
                            <div>
                                <label>
                                    {{ element["libelle_elem"] }}
                                    <input type="{{ element["type_elem"] }}">
                                </label>
                            </div>
                        {% endif %}
                    {% endfor %}
                </fieldset>
            {% endfor %}
        </div>
        <div id="zone_personnalisation">
            {% for categorie in composition %}
                <div class="set-hidde" id="set-{{ categorie["position_elem"] }}"
                     {% if loop.index0 != 0 %}hidden="" {% endif %}>
                    <select id="selecteur_element">
                        <option value="{{ categorie["position_elem"] }}" selected>Catégorie
                            - {{ categorie["libelle_elem"] }}</option>
                        {% for element in categorie["elements"] %}
                            <option value="{{ element["position_elem"] }}">Element
                                - {{ element["libelle_elem"] }}</option>
                        {% endfor %}
                    </select>

                    <!-- Iteration pour la version de la categorie-->
                    <div>
                        <div>
                            <h3>Texte</h3>
                            <!-- Sélection d'une police d'écriture -->
                            <label for="selecteur_police">Police</label>
                            <select id="selecteur_police" onchange="changer_police()">
                                {% for police in polices %}
                                    <option value="{{ police }}" style="font-family: {{ police }}"
                                            {% if police == categorie["police"] %} selected {% endif %}>
                                        {{ police }}
                                    </option>
                                {% endfor %}
                                <!-- Autres polices à rajouter éventuellement -->
                            </select>

                            <!-- Sélection de la taille de la police d'écriture -->
                            <label for="taille_police">Taille</label>
                            <input type="number" id="taille_police" min="15" max="100"
                                   value="{{ categorie["taille_texte"] }}"
                                   onchange="mettre_a_jour_texte()"><br>


                            <!-- Sélection de la couleur de la police d'écriture -->
                            <!-- Partie hexadéciamle -->
                            <label> Changer la couleur</label>

                            <!--Visualisation-->
                            <div id="visualisation">
                                <input type="color" id="color_picker" value="{{ categorie["couleur"] }}"
                                       oninput="mettre_a_jour_texte()">

                                <!--Visualisation du texte et de sa couleur-->
                                <div id="visualisation_texte">
                                    <span id="texte_visualisation">Ceci est le texte de visualisation de votre choix</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3>Champs</h3>

                            <!-- Sélection du Niveau -->
                            <label for="selecteur_niveau">Niveau</label>
                            <select id="selecteur_niveau">
                                <option value="0" {% if categorie["niveau"] == None %}selected{% endif %}>
                                    0 - Niveau individuel pour chaque élément de la fiche
                                </option>
                                <option value="1" {% if categorie["niveau"] == 1 %}selected{% endif %}>1 - Pas
                                    d'affichage
                                    - Elements cachés (appliquer à tout les éléments)
                                </option>
                                <option value="2" {% if categorie["niveau"] == 2 %}selected{% endif %}>2 - Facile -
                                    Pictogrammes (appliquer à tout les éléments)
                                </option>
                                <option value="2" {% if categorie["niveau"] == 3 %}selected{% endif %}>3 - Aidé -
                                    Pictogrammes
                                    et Texte (appliquer à tout les éléments)
                                </option>
                                <option value="2" {% if categorie["niveau"] == 4 %}selected{% endif %}>4 - Pro -
                                    Version d'examen (appliquer à tout les éléments)
                                </option>
                            </select>
                            <br>

                            <!-- Sélection du pictogramme à associer -->
                            <label for="selecteur_pictogramme">Pictogramme</label>
                            <select id="selecteur_pictogramme">
                                <!-- Pictos de la BD -->
                            </select>
                        </div>
                        <div>
                            <h3>Couleur de fond</h3>
                            <input type="color" id="color_picker" value="{{ categorie["couleur_fond"] }}"
                                   oninput="mettre_a_jour_couleur_fond()">
                        </div>
                        <div class="d-flex" id="actions_finales">
                            <button class="btn-secondary form-control">Reinitialiser (Par Défaut)</button>
                            <button class="btn-secondary form-control" disabled>Reinitialiser (Derniere Fiche)</button>
                            <button class="btn-primary form-control" disabled>Appliquer</button>
                        </div>
                    </div>


                    <!-- Iteration par elements dans la categorie-->
                    {% for element in categorie["elements"] %}
                        <div hidden="">
                            <div>
                                <h3>Texte</h3>
                                <!-- Sélection d'une police d'écriture -->
                                <label for="selecteur_police">Police</label>
                                <select id="selecteur_police" onchange="changer_police()">
                                    {% for police in polices %}
                                        <option value="{{ police }}" style="font-family: {{ police }}"
                                                {% if police == element["police"] %} selected {% endif %}>
                                            {{ police }}
                                        </option>
                                    {% endfor %}
                                    <!-- Autres polices à rajouter éventuellement -->
                                </select>

                                <!-- Sélection de la taille de la police d'écriture -->
                                <label for="taille_police">Taille</label>
                                <input type="number" id="taille_police" min="1" max="100"
                                       value="{{ element["taille_texte"] }}"
                                       onchange="mettre_a_jour_texte()"><br>


                                <!-- Sélection de la couleur de la police d'écriture -->
                                <!-- Partie hexadéciamle -->
                                <label> Changer la couleur</label>

                                <!--Visualisation-->
                                <div id="visualisation">
                                    <input type="color" id="color_picker" value="{{ element["couleur"] }}"
                                           oninput="mettre_a_jour_texte()">

                                    <!--Visualisation du texte et de sa couleur-->
                                    <div id="visualisation_texte">
                                        <span id="texte_visualisation">Ceci est le texte de visualisation de votre choix</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h3>Champ</h3>

                                <!-- Sélection du Niveau -->
                                <label for="selecteur_niveau">Niveau</label>
                                <select id="selecteur_niveau">
                                    <option value="1" {% if element["niveau"] == 1 %}selected{% endif %}>1 - Pas
                                        d'affichage - Elements cachés
                                    </option>
                                    <option value="2" {% if element["niveau"] == 2 %}selected{% endif %}>2 - Facile -
                                        Pictogrammes
                                    </option>
                                    <option value="2" {% if element["niveau"] == 3 %}selected{% endif %}>3 - Aidé -
                                        Pictogrammes et Texte
                                    </option>
                                    <option value="2" {% if element["niveau"] == 4 %}selected{% endif %}>4 - Pro -
                                        Version d'examen
                                    </option>
                                </select>
                                <br>

                                <!-- Sélection du pictogramme à associer -->
                                <label for="selecteur_pictogramme">Pictogramme</label>
                                <select id="selecteur_pictogramme">
                                    <!-- Pictos de la BD -->
                                </select>
                            </div>
                            <div>
                                <h3>Couleur de fond</h3>
                                <input type="color" id="color_picker" value="{{ element["couleur_fond"] }}"
                                       oninput="mettre_a_jour_couleur_fond()">
                            </div>
                            <div class="d-flex" id="actions_finales">
                                <button class="btn-secondary form-control">Reinitialiser (Par Défaut)</button>
                                <button class="btn-secondary form-control" disabled>Reinitialiser (Derniere Fiche)
                                </button>
                                <button class="btn-primary form-control" disabled>Appliquer</button>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </div>

    <script defer>
        mettre_a_jour_texte()
    </script>
{% endblock %}